cpu-bind=MASK - gb001, task  0  0 [1418948]: mask 0xff0000000000000 set
WARNING:root:Some enhanced features not available: cannot import name 'compute_class_weights' from 'tornet.data.balanced_sampling' (/projects/weilab/shenb/csci3370/code_submission/tornet_enhanced/tornet/data/balanced_sampling.py)
WARNING:root:Falling back to baseline model with limited enhancements
INFO:root:TORNET_ROOT=/projects/weilab/shenb/csci3370/data
INFO:root:Cleared GPU memory. Available: 150.11 GB
INFO:root:Using torch backend
INFO:root:Using keras dataloader
INFO:root:Running with enhanced config:
INFO:root:{'epochs': 20, 'input_variables': ['DBZ', 'VEL', 'KDP', 'RHOHV', 'ZDR', 'WIDTH'], 'train_years': [2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022], 'val_years': [2021, 2022], 'batch_size': 16, 'model': 'baseline', 'start_filters': 48, 'learning_rate': 0.0001, 'decay_steps': 1386, 'decay_rate': 0.958, 'l2_reg': 1e-05, 'wN': 1.0, 'w0': 1.0, 'w1': 1.0, 'w2': 2.0, 'wW': 0.5, 'label_smooth': 0.0, 'loss': 'cce', 'head': 'maxpool', 'exp_name': 'tornado_enhanced_tornet', 'exp_dir': '/projects/weilab/shenb/csci3370/code_submission/outputs/tornado_enhanced_20251204233447-1853592-None', 'dataloader': 'keras', 'dataloader_kwargs': {}, 'use_augmentation': False, 'rotation_range': 10.0, 'translation_range': 0.05, 'scale_range': (0.95, 1.05), 'noise_std': 0.005, 'brightness_range': 0.05, 'contrast_range': (0.95, 1.05), 'flip_probability': 0.3, 'use_class_balancing': False, 'oversample_ratio': 1.5, 'class_weight_method': 'balanced', 'use_cosine_annealing': False, 'warmup_epochs': 3, 'weight_decay': 0.0001, 'use_multiscale': False, 'use_attention': False, 'use_residual': False, 'config': {'epochs': 20, 'input_variables': ['DBZ', 'VEL', 'KDP', 'RHOHV', 'ZDR', 'WIDTH'], 'train_years': [2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022], 'val_years': [2021, 2022], 'batch_size': 64, 'model': 'simple_enhanced_cnn', 'start_filters': 16, 'learning_rate': 0.001, 'decay_steps': 1386, 'decay_rate': 0.958, 'l2_reg': '1e-05', 'wN': 1.0, 'w0': 1.0, 'w1': 1.0, 'w2': 2.0, 'wW': 0.5, 'label_smooth': 0.0, 'loss': 'focal_imbalanced', 'head': 'maxpool', 'exp_name': 'tornado_enhanced_tornet', 'exp_dir': '/projects/weilab/shenb/csci3370/code_submission/outputs', 'dataloader': 'keras', 'dataloader_kwargs': {'select_keys': ['DBZ', 'VEL', 'KDP', 'RHOHV', 'ZDR', 'WIDTH', 'range_folded_mask', 'coordinates']}, 'use_attention': True, 'use_residual': True, 'use_multiscale': True, 'focal_alpha': 0.5, 'focal_gamma': 1.5, 'tversky_alpha': 0.7, 'tversky_beta': 0.3, 'use_augmentation': True, 'use_class_balancing': True, 'early_stopping_patience': 5, 'reduce_lr_patience': 3, 'reduce_lr_factor': 0.5, 'use_cosine_annealing': True, 'warmup_epochs': 3, 'use_mixup': False, 'use_cutmix': False, 'mixup_alpha': 0.2, 'cutmix_alpha': 1.0, 'class_weight_method': 'balanced', 'oversample_ratio': 1.2, 'focal_weight': 0.8, 'dice_weight': 0.2, 'class_balanced_beta': 0.9999, 'data_partitioning': 'julian_day_modulo', 'julian_modulo': 20, 'training_threshold': 17, 'overlap_removal': True, 'overlap_time_minutes': 30, 'overlap_distance_degrees': 0.25, 'rotation_range': 10.0, 'translation_range': 0.05, 'scale_range': [0.95, 1.05], 'noise_std': 0.005, 'brightness_range': 0.05, 'contrast_range': [0.95, 1.05], 'flip_probability': 0.3, 'weight_decay': '1e-4'}}
INFO:root:Building enhanced model with conservative settings
INFO:root:expdir=/projects/weilab/shenb/csci3370/code_submission/outputs/tornado_enhanced_20251204233447-1853592-None/tornado_enhanced_tornet251204233453-1853592-None
INFO:root:Starting enhanced training for 20 epochs with strategic improvements
